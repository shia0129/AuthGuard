import baseApi from '@api/common/baseApi';
import HsLib from '@modules/common/HsLib';

const malwareDetectHistoryApi = {
  ...baseApi,

  getMalwareDetectHisList: async (parameters) => {
    const result = await malwareDetectHistoryApi.axios.get(
      '/api/status-management/malware-detection-history',
      {
        params: {
          ...parameters,
          workStartTime: HsLib.removeDateTimeFormat(parameters.workStartTime),
          workEndTime: HsLib.removeDateTimeFormat(parameters.workEndTime),
        },
      },
    );

    if (!result.data.errorYn) {
      return result.data.data;
    }
  },
  getMalwareDetectHisListExcel: async (parameters) => {
    return await malwareDetectHistoryApi.axios.get(
      '/api/status-management/malware-detection-history/excel',
      {
        params: parameters,
        responseType: 'blob',
      },
    );
  },
};

export default malwareDetectHistoryApi;
